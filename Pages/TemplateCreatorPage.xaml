<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="CameraMaui.Pages.TemplateCreatorPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:skia="clr-namespace:SkiaSharp.Views.Maui.Controls;assembly=SkiaSharp.Views.Maui.Controls"
    Title="ç®­é ­ç¯„æœ¬è£½ä½œ"
    BackgroundColor="#F5EFE0">

    <ContentPage.Resources>
        <Style x:Key="CardFrame" TargetType="Frame">
            <Setter Property="BackgroundColor" Value="#2B8B8B"/>
            <Setter Property="BorderColor" Value="#1E5B5B"/>
            <Setter Property="CornerRadius" Value="16"/>
            <Setter Property="Padding" Value="12"/>
            <Setter Property="HasShadow" Value="True"/>
        </Style>

        <Style x:Key="SecondaryCardFrame" TargetType="Frame">
            <Setter Property="BackgroundColor" Value="#1E4B5C"/>
            <Setter Property="BorderColor" Value="#153A48"/>
            <Setter Property="CornerRadius" Value="16"/>
            <Setter Property="Padding" Value="12"/>
            <Setter Property="HasShadow" Value="True"/>
        </Style>

        <Style x:Key="ActionButton" TargetType="Button">
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="FontAttributes" Value="Bold"/>
            <Setter Property="HeightRequest" Value="48"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="BackgroundColor" Value="#F9C846"/>
            <Setter Property="TextColor" Value="#1E4B5C"/>
        </Style>

        <Style x:Key="SecondaryButton" TargetType="Button">
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="FontAttributes" Value="Bold"/>
            <Setter Property="HeightRequest" Value="48"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="BackgroundColor" Value="#2B8B8B"/>
            <Setter Property="TextColor" Value="White"/>
        </Style>
    </ContentPage.Resources>

    <Grid RowDefinitions="*,Auto,Auto" Padding="12">

        <!-- ä¸»è¦åœ–ç‰‡å€åŸŸ - ä½¿ç”¨ SKCanvasView -->
        <Frame Grid.Row="0" Style="{StaticResource CardFrame}" Padding="0">
            <Grid RowDefinitions="Auto,*">
                <Grid ColumnDefinitions="*,Auto" BackgroundColor="#1E5B5B" Padding="14,10">
                    <Label Text="ðŸ“· ä¾†æºåœ–ç‰‡" TextColor="#F9C846" FontAttributes="Bold" FontSize="16" VerticalOptions="Center" />
                    <Label x:Name="lblStatus" Text="è¼‰å…¥åœ–ç‰‡é–‹å§‹" TextColor="#7BC5C5" FontSize="13" Grid.Column="1" VerticalOptions="Center" />
                </Grid>

                <Grid Grid.Row="1" BackgroundColor="#F5EFE0" Margin="10">
                    <Frame CornerRadius="12" Padding="0" HasShadow="False" BackgroundColor="White" BorderColor="#E8E4D9">
                        <!-- SKCanvasView for drawing image and selection -->
                        <skia:SKCanvasView x:Name="skCanvasView"
                            PaintSurface="OnPaintSurface"
                            EnableTouchEvents="True"
                            Touch="OnCanvasTouch" />
                    </Frame>

                    <!-- èªªæ˜Žè¦†è“‹å±¤ -->
                    <VerticalStackLayout x:Name="instructionOverlay" IsVisible="True" HorizontalOptions="Center" VerticalOptions="Center" Spacing="12">
                        <Frame BackgroundColor="#F9C846" CornerRadius="50" WidthRequest="80" HeightRequest="80" Padding="0" HasShadow="False" HorizontalOptions="Center" BorderColor="Transparent">
                            <Label Text="ðŸŽ¯" FontSize="36" HorizontalOptions="Center" VerticalOptions="Center" />
                        </Frame>
                        <Label Text="1. è¼‰å…¥å«æœ‰ç’°ç¢¼çš„åœ–ç‰‡" TextColor="#1E4B5C" FontSize="14" HorizontalOptions="Center" />
                        <Label Text="2. é»žæ“Šç®­é ­å€åŸŸé€²è¡Œé¸å–" TextColor="#6B6660" FontSize="14" HorizontalOptions="Center" />
                        <Label Text="3. èª¿æ•´é¸å–å¤§å°ä¸¦å„²å­˜ç¯„æœ¬" TextColor="#6B6660" FontSize="14" HorizontalOptions="Center" />
                    </VerticalStackLayout>
                </Grid>
            </Grid>
        </Frame>

        <!-- ç¯„æœ¬é è¦½é¢æ¿ - é›™ç¯„æœ¬ -->
        <Frame Grid.Row="1" Style="{StaticResource SecondaryCardFrame}" Margin="0,10,0,0" Padding="14">
            <Grid RowDefinitions="Auto,Auto" RowSpacing="10">
                <!-- ç¯„æœ¬é¡žåž‹é¸æ“‡å™¨ -->
                <Grid ColumnDefinitions="*,*,Auto" ColumnSpacing="10">
                    <!-- æ·±è‰²ç®­é ­ç¯„æœ¬ -->
                    <Frame x:Name="frameDarkTemplate" BackgroundColor="#1E5B5B" CornerRadius="12" Padding="8" HasShadow="False" BorderColor="#F9C846">
                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="8">
                            <Frame BackgroundColor="#333333" CornerRadius="8" Padding="2" HasShadow="False" WidthRequest="50" HeightRequest="50" BorderColor="#555555">
                                <Image x:Name="darkTemplatePreview" Aspect="AspectFit" />
                            </Frame>
                            <VerticalStackLayout Grid.Column="1" Spacing="2" VerticalOptions="Center">
                                <Label Text="ðŸŒ™ æ·±è‰²ç®­é ­" TextColor="#F9C846" FontSize="13" FontAttributes="Bold" />
                                <Label x:Name="lblDarkTemplateStatus" Text="æœªè¨­å®š" TextColor="#7BC5C5" FontSize="11" />
                            </VerticalStackLayout>
                        </Grid>
                        <Frame.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnDarkTemplateSelected" />
                        </Frame.GestureRecognizers>
                    </Frame>

                    <!-- æ·ºè‰²ç®­é ­ç¯„æœ¬ -->
                    <Frame x:Name="frameLightTemplate" Grid.Column="1" BackgroundColor="#1E5B5B" CornerRadius="12" Padding="8" HasShadow="False" BorderColor="Transparent">
                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="8">
                            <Frame BackgroundColor="White" CornerRadius="8" Padding="2" HasShadow="False" WidthRequest="50" HeightRequest="50" BorderColor="#E8E4D9">
                                <Image x:Name="lightTemplatePreview" Aspect="AspectFit" />
                            </Frame>
                            <VerticalStackLayout Grid.Column="1" Spacing="2" VerticalOptions="Center">
                                <Label Text="â˜€ï¸ æ·ºè‰²ç®­é ­" TextColor="#F9C846" FontSize="13" FontAttributes="Bold" />
                                <Label x:Name="lblLightTemplateStatus" Text="æœªè¨­å®š" TextColor="#7BC5C5" FontSize="11" />
                            </VerticalStackLayout>
                        </Grid>
                        <Frame.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnLightTemplateSelected" />
                        </Frame.GestureRecognizers>
                    </Frame>

                    <!-- é¸å–å¤§å°æŽ§åˆ¶ -->
                    <VerticalStackLayout Grid.Column="2" Spacing="4" VerticalOptions="Center">
                        <Label Text="é¸å–å¤§å°" TextColor="#7BC5C5" FontSize="11" HorizontalTextAlignment="Center" />
                        <HorizontalStackLayout Spacing="4">
                            <Button Text="-" WidthRequest="36" HeightRequest="32" CornerRadius="8"
                                    BackgroundColor="#1E5B5B" TextColor="#F9C846" FontAttributes="Bold" Clicked="OnSizeDecreaseClicked" />
                            <Frame BackgroundColor="#1E5B5B" CornerRadius="8" Padding="8,2" HasShadow="False" BorderColor="Transparent">
                                <Label x:Name="lblSelectionSize" Text="50" TextColor="#F9C846" FontSize="13" FontAttributes="Bold"
                                       WidthRequest="26" HorizontalTextAlignment="Center" VerticalOptions="Center" />
                            </Frame>
                            <Button Text="+" WidthRequest="36" HeightRequest="32" CornerRadius="8"
                                    BackgroundColor="#1E5B5B" TextColor="#F9C846" FontAttributes="Bold" Clicked="OnSizeIncreaseClicked" />
                        </HorizontalStackLayout>
                    </VerticalStackLayout>
                </Grid>

                <!-- ç‹€æ…‹è³‡è¨Š -->
                <HorizontalStackLayout Grid.Row="1" Spacing="8" HorizontalOptions="Center">
                    <Label x:Name="lblTemplateInfo" Text="é»žæ“Šä¸Šæ–¹é¸æ“‡ç¯„æœ¬é¡žåž‹ï¼Œå†å¾žåœ–ç‰‡ä¸­é¸å–ç®­é ­å€åŸŸ" TextColor="#7BC5C5" FontSize="12" />
                </HorizontalStackLayout>
            </Grid>
        </Frame>

        <!-- å‹•ä½œæŒ‰éˆ• -->
        <Grid Grid.Row="2" ColumnDefinitions="*,*,*,*" ColumnSpacing="8" Padding="0,10,0,0">
            <Button Grid.Column="0" Text="ðŸ“ è¼‰å…¥åœ–ç‰‡" Style="{StaticResource SecondaryButton}" BackgroundColor="#4A8B5C"
                    Clicked="OnLoadImageClicked" />
            <Button Grid.Column="1" Text="ðŸ“‚ è¼‰å…¥ç¯„æœ¬" Style="{StaticResource SecondaryButton}"
                    Clicked="OnLoadTemplateClicked" />
            <Button Grid.Column="2" Text="ðŸ’¾ å„²å­˜ç¯„æœ¬" Style="{StaticResource ActionButton}"
                    Clicked="OnSaveTemplateClicked" x:Name="btnSave" IsEnabled="False" />
            <Button Grid.Column="3" Text="â† è¿”å›ž" Style="{StaticResource SecondaryButton}" BackgroundColor="#8A8578"
                    Clicked="OnBackClicked" />
        </Grid>

    </Grid>

</ContentPage>
